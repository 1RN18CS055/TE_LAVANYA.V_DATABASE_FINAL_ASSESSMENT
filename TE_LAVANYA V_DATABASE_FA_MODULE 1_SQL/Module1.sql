-----MODULE 1-------
----Normalization----
-----TABLE CREATION AND INSERTION----

CREATE TABLE TE_FA_HOSPITAL
(
HOSPITAL_ID INT PRIMARY KEY,
HOSPITAL_NAME VARCHAR(50),  
CITY VARCHAR(50)
)

INSERT INTO TE_FA_HOSPITAL VALUES(1,'BGS','BANGALORE')
INSERT INTO TE_FA_HOSPITAL VALUES(2,'MANIPAL','UDUPI')
INSERT INTO TE_FA_HOSPITAL VALUES(3,'VICTORIA','BANGALORE')
INSERT INTO TE_FA_HOSPITAL VALUES(4,'UNITY','MANGALORE')
INSERT INTO TE_FA_HOSPITAL VALUES(5,'FORTIS','BANGALORE')
INSERT INTO TE_FA_HOSPITAL VALUES(6,'APPOLO','BANGALORE')

SELECT * FROM TE_FA_HOSPITAL

--------------------------------------------------------------------------------------------------------------

CREATE TABLE TE_FA_DOCTOR
(
DOCTOR_ID VARCHAR(50) PRIMARY KEY,
DOCTOR_NAME VARCHAR(50),
SPECIALIST VARCHAR(50),
HOSPITAL_ID INT FOREIGN KEY REFERENCES TE_FA_HOSPITAL(HOSPITAL_ID)
)

DROP TABLE TE_FA_DOCTOR

INSERT INTO TE_FA_DOCTOR VALUES('B100','DR.SMITH','EYE',1)
INSERT INTO TE_FA_DOCTOR VALUES('B101','DR.JOHN','CARDIOLOGY',1)
INSERT INTO TE_FA_DOCTOR VALUES('B102','DR.SITA','DERMATOLOGY',1)
INSERT INTO TE_FA_DOCTOR VALUES('B103','DR.DANISH','PEDIATRICIAN',1)
INSERT INTO TE_FA_DOCTOR VALUES('B104','DR.SANA','GYNECOLOGISTS',1)
INSERT INTO TE_FA_DOCTOR VALUES('M100','DR.ANA','ENDOCRINOLOGIST',2)
INSERT INTO TE_FA_DOCTOR VALUES('M101','DR.GITA','GASTRONEOLOGISTS',2)
INSERT INTO TE_FA_DOCTOR VALUES('M102','DR.GIMMY','NEPHROLOGISTS',2)
INSERT INTO TE_FA_DOCTOR VALUES('M103','DR.JERRY','UROLOGIST',2)
INSERT INTO TE_FA_DOCTOR VALUES('M104','DR.SHYAM','PULMONOLOGIST',2)
INSERT INTO TE_FA_DOCTOR VALUES('V100','DR.NIMISHA','ENDOCRINOLOGIST',3)
INSERT INTO TE_FA_DOCTOR VALUES('V101','DR.GUNA','GASTRONEOLOGISTS',3)
INSERT INTO TE_FA_DOCTOR VALUES('V102','DR.SHARANYA','NEPHROLOGISTS',3)
INSERT INTO TE_FA_DOCTOR VALUES('V103','DR.JIM','UROLOGIST',3)
INSERT INTO TE_FA_DOCTOR VALUES('V104','DR.SHREYAS','PULMONOLOGIST',3)
INSERT INTO TE_FA_DOCTOR VALUES('U101','DR.KARTHIK','GASTRONEOLOGISTS',4)
INSERT INTO TE_FA_DOCTOR VALUES('U102','DR.LAVANYA','CARDIOLOGY',4)
INSERT INTO TE_FA_DOCTOR VALUES('U103','DR.SHRADDHA','DERMATOLOGY',4)
INSERT INTO TE_FA_DOCTOR VALUES('U104','DR.ANUSHA','GYNECOLOGISTS',4)
INSERT INTO TE_FA_DOCTOR VALUES('F100','DR.AJAY','ONCOLOGIST',5)
INSERT INTO TE_FA_DOCTOR VALUES('A100','DR.VIJAY','RADIOLOGIST',6)

SELECT * FROM TE_FA_DOCTOR

----------------------------------------------------------------------------------------------------------------

CREATE TABLE TE_FA_PATIENT
(
PATIENT_ID VARCHAR(50) PRIMARY KEY, 
PATIENT_NAME VARCHAR(50),
GENDER VARCHAR(50), 
AGE INT,
CHECKUP VARCHAR(50),
MEDICINE VARCHAR(50),
DOCTOR_ID VARCHAR(50) FOREIGN KEY REFERENCES TE_FA_DOCTOR(DOCTOR_ID) 
) 

INSERT INTO TE_FA_PATIENT VALUES('P10','AMELIA','FEMALE',19,'EYE','ACICLOVIR','B100')
INSERT INTO TE_FA_PATIENT VALUES('P11','AME','FEMALE',20,'HEART','ACEBUTOLOL','B101')
INSERT INTO TE_FA_PATIENT VALUES('P12','AVA','FEMALE',19,'SKIN','BIAFINE','B102')
INSERT INTO TE_FA_PATIENT VALUES('P13','AVERY','FEMALE',11,'CHILDREN','CEPHALEXIN','B103')
INSERT INTO TE_FA_PATIENT VALUES('P14','AIDEN','FEMALE',25,'PREGNANCY','IMMODIUM','B104')

INSERT INTO TE_FA_PATIENT VALUES('P15','ASHER','FEMALE',67,'EYE','ACICLOVIR','B100')
INSERT INTO TE_FA_PATIENT VALUES('P16','AREIA','FEMALE',20,'HEART','ACEBUTOLOL','B101')
INSERT INTO TE_FA_PATIENT VALUES('P17','ARDIAN','MALE',19,'SKIN','BIAFINE','B102')
INSERT INTO TE_FA_PATIENT VALUES('P18','AVON','MALE',7,'CHILDREN','CEPHALEXIN','B103')
INSERT INTO TE_FA_PATIENT VALUES('P19','ALISON','MALE',40,'PREGNANCY','IMMODIUM','B104') 

INSERT INTO TE_FA_PATIENT VALUES('P20','ADELIN','MALE',40,'DIABETES','INSULIN','M100')
INSERT INTO TE_FA_PATIENT VALUES('P21','ATHENA','FEMALE',20,'DIGESTIVE SYSTEM','NEXIUM','M101')
INSERT INTO TE_FA_PATIENT VALUES('P22','ASTIN','MALE',19,'KIDNEY','CAPTROPIL','M102')
INSERT INTO TE_FA_PATIENT VALUES('P23','BAILEY','MALE',60,'URINARY TRACT','BACTRIM','M103')
INSERT INTO TE_FA_PATIENT VALUES('P24','BABITA','FEMALE',40,'BREATHING','NEBULIZER','M104')

INSERT INTO TE_FA_PATIENT VALUES('P25','BAIL','MALE',50,'DIABETES','INSULIN','V100')
INSERT INTO TE_FA_PATIENT VALUES('P26','BHOOMI','FEMALE',70,'DIGESTIVE SYSTEM','NEXIUM','V101')
INSERT INTO TE_FA_PATIENT VALUES('P27','BLAKE','MALE',19,'KIDNEY','CAPTROPIL','V102')
INSERT INTO TE_FA_PATIENT VALUES('P28','BADAL','MALE',21,'URINARY TRACT','BACTRIM','V103')
INSERT INTO TE_FA_PATIENT VALUES('P29','BALAGI','MALE',40,'BREATHING','NEBULIZER','V104')

INSERT INTO TE_FA_PATIENT VALUES('P30','MAHIMA','FEMALE',50,'DIGESTIVE SYSTEM','NEXIUM','U101')
INSERT INTO TE_FA_PATIENT VALUES('P31','BHAVANA','FEMALE',70,'HEART','ACEBUTOLOL','U102')
INSERT INTO TE_FA_PATIENT VALUES('P32','ANANYA','FEMALE',19,'KIDNEY','CAPTROPIL','F100')
INSERT INTO TE_FA_PATIENT VALUES('P33','ANAGHA','FEMALE',21,'ONCOLOGY','NEULASTA','A100')
INSERT INTO TE_FA_PATIENT VALUES('P34','KEERTHANA','FEMALE',40,'RADIOLOGY','GADOTERIDOL','V104')

INSERT INTO TE_FA_PATIENT VALUES('P35','ASFIYA','FEMALE',50,'DIGESTIVE SYSTEM','NEXIUM','U101')
INSERT INTO TE_FA_PATIENT VALUES('P36','AISHWARYA','FEMALE',70,'HEART','ACEBUTOLOL','U102')
INSERT INTO TE_FA_PATIENT VALUES('P37','MEENA','FEMALE',19,'KIDNEY','CAPTROPIL','F100')
INSERT INTO TE_FA_PATIENT VALUES('P38','KAVITHA','FEMALE',21,'ONCOLOGY','NEULASTA','A100')
INSERT INTO TE_FA_PATIENT VALUES('P39','JYOTHI','FEMALE',40,'RADIOLOGY','GADOTERIDOL','V104') 

INSERT INTO TE_FA_PATIENT VALUES('P40','CHITRA','FEMALE',19,'EYE','ACICLOVIR','B100')
INSERT INTO TE_FA_PATIENT VALUES('P41','CHARLIE','MALE',20,'HEART','ACEBUTOLOL','B101')
INSERT INTO TE_FA_PATIENT VALUES('P42','CARINA','FEMALE',19,'SKIN','BIAFINE','B102')
INSERT INTO TE_FA_PATIENT VALUES('P43','CHAITHAN','MALE',11,'CHILDREN','CEPHALEXIN','B103')
INSERT INTO TE_FA_PATIENT VALUES('P44','CHANCHAN','MALE',25,'PREGNANCY','IMMODIUM','B104')

INSERT INTO TE_FA_PATIENT VALUES('P45','CALVIN','MALE',67,'EYE','ACICLOVIR','B100')
INSERT INTO TE_FA_PATIENT VALUES('P46','CARTER','MALE',20,'HEART','ACEBUTOLOL','B101')
INSERT INTO TE_FA_PATIENT VALUES('P47','COLE','MALE',19,'SKIN','BIAFINE','B102')
INSERT INTO TE_FA_PATIENT VALUES('P48','CASEY','MALE',7,'CHILDREN','CEPHALEXIN','B103')
INSERT INTO TE_FA_PATIENT VALUES('P49','CALEB','MALE',40,'PREGNANCY','IMMODIUM','B104')

INSERT INTO TE_FA_PATIENT VALUES('P50','DANIEL','FEMALE',40,'DIABETES','INSULIN','M100')
INSERT INTO TE_FA_PATIENT VALUES('P51','DAVID','MALE',20,'DIGESTIVE SYSTEM','NEXIUM','M101')
INSERT INTO TE_FA_PATIENT VALUES('P52','DYLON','FEMALE',19,'KIDNEY','CAPTROPIL','M102')
INSERT INTO TE_FA_PATIENT VALUES('P53','DECLAN','MALE',60,'URINARY TRACT','BACTRIM','M103')
INSERT INTO TE_FA_PATIENT VALUES('P54','DAMIEN','FEMALE',40,'BREATHING','NEBULIZER','M104')

INSERT INTO TE_FA_PATIENT VALUES('P55','GEORGE','MALE',50,'DIABETES','INSULIN','V100')
INSERT INTO TE_FA_PATIENT VALUES('P56','GAVIN','MALE',70,'DIGESTIVE SYSTEM','NEXIUM','V101')
INSERT INTO TE_FA_PATIENT VALUES('P57','GAYLE','MALE',19,'KIDNEY','CAPTROPIL','V102')
INSERT INTO TE_FA_PATIENT VALUES('P58','GIFFIN','MALE',21,'URINARY TRACT','BACTRIM','V103')
INSERT INTO TE_FA_PATIENT VALUES('P59','GRAHAM','MALE',40,'BREATHING','NEBULIZER','V104')

SELECT * FROM TE_FA_PATIENT

------------------------------------------------------------------------------------------------------------
-----JOINING TABLE------

SELECT H.HOSPITAL_ID,H.HOSPITAL_NAME,H.CITY,D.DOCTOR_ID,D.DOCTOR_NAME,D.SPECIALIST,D.HOSPITAL_ID,P.PATIENT_ID,P.PATIENT_NAME,P.CHECKUP,P.MEDICINE,P.DOCTOR_ID
FROM TE_FA_HOSPITAL AS H
INNER JOIN TE_FA_DOCTOR AS D
ON H.HOSPITAL_ID=D.HOSPITAL_ID
INNER JOIN TE_FA_PATIENT AS P 
ON D.DOCTOR_ID=P.DOCTOR_ID 

-------------------------------------------------------------------------------------------------------------
--------CREATING VIEWS-------
------VIEW1-------
CREATE VIEW TE_FA_HOSPITAL1
AS
SELECT * FROM TE_FA_HOSPITAL

SELECT * FROM TE_FA_HOSPITAL1

-------VIEW2--------
CREATE VIEW TE_FA_DOCTOR1 
AS
SELECT * FROM TE_FA_DOCTOR

SELECT DOCTOR_ID 
FROM TE_FA_DOCTOR1
WHERE SPECIALIST='CARDIOLOGY'

-------VIEW3---------
CREATE VIEW TE_FA_PATIENT1 
AS
SELECT * FROM TE_FA_PATIENT

SELECT COUNT(*) 
FROM TE_FA_PATIENT1

--------------------------------------------------------------------------------------------------------------


------------DDL,DML,OPERATIONS-----------
-----DATA SOURCE 1---- 
CREATE TABLE TE_FA_COVIDHEALTHCARE
(
DRG_ID INT,	
DRG_Definition VARCHAR(50),
Provider_Id	INT,
Provider_Name VARCHAR(50),	
Provider_Street_Address	VARCHAR(50),
Provider_City VARCHAR(50),
Provider_State VARCHAR(50),	
Provider_Zip_Code VARCHAR(50), 
Description	VARCHAR(50),
Total_Discharges INT
) 

INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10001,'SOUTHEAST ALABAMA MEDICAL CENTER','1108 ROSS CLARK CIRCLE','DOTHAN','AL','36301','AL - Dothan',91) 
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10055,'FLOWERS HOSPITAL','4370 WEST MAIN STREET','DOTHAN','AL','36305','AL - Dothan',45)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10056,'ST VINCENTS BIRMINGHAM','810 ST VINCENTS DRIVE','BIRMINGHAM','AL','35205','AL - Birmingham',43)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10078,'NORTHEAST ALABAMA REGIONAL MED CENTER','400 EAST 10TH STREET','ANNISTON','AL','36207','AL - Birmingham',21)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10083,'SOUTH BALDWIN REGIONAL MEDICAL CENTER','1613 NORTH MCKENZIE STREET','FOLEY','AL','36535','AL - Mobile',15)

INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10085,'DECATUR GENERAL HOSPITAL','1201 7TH STREET SE','DECATUR','AL','35609','AL - Huntsville',27)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10090,'PROVIDENCE HOSPITAL','6801 AIRPORT BOULEVARD','MOBILE','AL','36608','AL - Mobile',27)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10092,'D C H REGIONAL MEDICAL CENTER','809 UNIVERSITY BOULEVARD EAST','TUSCALOOSA','AL','35401','AL - Tuscaloosa',31)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(57,'DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC',340020,'CENTRAL CAROLINA HOSPITAL','1135 CARTHAGE ST','SANFORD','NC','27330','NC - Durham',18)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(57,'DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC',340021,'CLEVELAND REGIONAL MEDICAL CENTER','201 E GROVER ST','SHELBY','NC','28150','NC - Charlotte',14)

INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(57,'DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC',340028,'CAPE FEAR VALLEY MEDICAL CENTER','1638 OWEN DRIVE P O BOX 2000','FAYETTEVILLE','NC','28302','NC - Raleigh',31)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(57,'DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC',340030,'DUKE UNIVERSITY HOSPITAL','PO BOX 3708 DUMC  ERWIN RD','DURHAM','NC','27710','NC - Durham',40)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(57,'DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC',340032,'GASTON MEMORIAL HOSPITAL','2525 COURT DR','GASTONIA','NC','28052','NC - Charlotte',25)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(202,'BRONCHITIS & ASTHMA W CC/MCC',230132,'HURLEY MEDICAL CENTER','ONE HURLEY PLAZA','FLINT','MI','48503','MI - Flint',12)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(202,'BRONCHITIS & ASTHMA W CC/MCC',230141,'MCLAREN FLINT','401 S BALLENGER HIGHWAY','FLINT','MI','48532','MI - Flint',41)

INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(202,'BRONCHITIS & ASTHMA W CC/MCC',230146,'HENRY FORD WYANDOTTE HOSPITAL','2333 BIDDLE AVE','WYANDOTTE','MI','48192','MI - Dearborn',16)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(202,'BRONCHITIS & ASTHMA W CC/MCC',230151,'BOTSFORD HOSPITAL','28050 GRAND RIVER AVENUE','FARMINGTON HILL','MI','48336','MI - Ann Arbor',32)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(202,'BRONCHITIS & ASTHMA W CC/MCC',230156,'ST JOSEPH MERCY HOSPITAL','5301 E HURON RIVER DR','ANN ARBOR','MI','48106','MI - Ann Arbor',48)

INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(207,'RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT',340147,'NASH GENERAL HOSPITAL','2460 CURTIS ELLIS DRIVE','ROCKY MOUNT','NC','27804','NC - Raleigh',24)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(207,'RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT',340155,'DURHAM REGIONAL HOSPITAL','3643 N ROXBORO ROAD','DURHAM','NC','27704','NC - Durham',19)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(207,'RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT',350011,'SANFORD MEDICAL CENTER FARGO','801 BROADWAY NORTH','FARGO','ND','58122','ND - Fargo/Moorhead MN',35)
INSERT INTO TE_FA_COVIDHEALTHCARE VALUES(207,'RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT',350015,'MEDCENTER ONE','300 N 7TH ST','BISMARCK','ND','58506','ND - Bismarck',13)

SELECT * FROM TE_FA_COVIDHEALTHCARE


UPDATE TE_FA_COVIDHEALTHCARE
SET Provider_Name='ANANYA'
WHERE DRG_ID=207

DELETE FROM TE_FA_COVIDHEALTHCARE
WHERE DRG_ID=207

ALTER TABLE TE_FA_COVIDHEALTHCARE 
ADD Average_Medicare_Payments FLOAT 

TRUNCATE TABLE TE_FA_COVIDHEALTHCARE

DROP TABLE TE_FA_COVIDHEALTHCARE

--------------------------------------------------------------------------------------------------------------
------------DDL,DML,DCL OPERATIONS-----------
-----DATA SOURCE2----
CREATE TABLE TE_FA_CINEMA
(
Film_Type VARCHAR(50),
film_code INT,
cinema_code INT,	
total_sales INT,
tickets_sold INT,
tickets_out INT,	
show_time INT,	
occu_perc FLOAT,
ticket_price FLOAT,	
ticket_use INT,	
capacity INT	
) 

INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,304,3900000,26,0,4,4.26,150000,26,610)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,352,3360000,42,0,5,8.08,80000,42,520)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,489,2560000,32,0,4,20,80000,32,160)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,429,1200000,12,0,1,11.01,100000,12,109)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,524,1200000,15,0,3,16.67,80000,15,90)

INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,71,1050000,7,0,3,0.98,150000,7,714)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,163,1020000,10,0,3,7.69,102000,10,130)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,450,750000,5,0,3,1.57,150000,5,318)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,51,750000,11,0,2,0.95,68181.81818,11,1158)
INSERT INTO TE_FA_CINEMA VALUES('Romance',1492,522,600000,4,0,3,1.55,150000,4,258)

INSERT INTO TE_FA_CINEMA VALUES('Horror',1484,120,8500000,112,0,6,4.99,75892.85714,112,2244)
INSERT INTO TE_FA_CINEMA VALUES('Horror',1484,115,7100000,142,0,1,49.13,50000,142,289)
INSERT INTO TE_FA_CINEMA VALUES('Horror',1484,39,6600000,114,0,3,22.09,57894.73684,114,516)
INSERT INTO TE_FA_CINEMA VALUES('Horror',1484,162,6510000,119,0,6,2.04,54705.88235,119,5833)
INSERT INTO TE_FA_CINEMA VALUES('Horror',1484,352,6150000,41,0,1,37.96,150000,41,108)

INSERT INTO TE_FA_CINEMA VALUES('Family',1483,528,33500000,341,0,6,42.41,98240.46921,341,804)
INSERT INTO TE_FA_CINEMA VALUES('Family',1483,417,31935000,333,0,5,22.05,95900.9009,333,1510)
INSERT INTO TE_FA_CINEMA VALUES('Family',1483,396,30100000,301,0,3,68.25,100000,301,441)
INSERT INTO TE_FA_CINEMA VALUES('Family',1483,175,30000000,500,0,12,8.8,60000,500,5682)
INSERT INTO TE_FA_CINEMA VALUES('Family',1483,456,29840000,426,0,6,71.45,70046.94836,426,596)

SELECT * FROM TE_FA_CINEMA

UPDATE TE_FA_CINEMA
SET Film_Type='ACTION'
WHERE film_code=1483

DELETE FROM TE_FA_CINEMA
WHERE film_code=1483

ALTER TABLE TE_FA_CINEMA 
ADD BOOKING_ID INT

TRUNCATE TABLE TE_FA_CINEMA

DROP TABLE TE_FA_CINEMA 

--------------------------------------------------------------------------------------------------------------
